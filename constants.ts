
import { Student, SubjectScore } from './types';

// Helper to calculate grade from score
export const calculateGrade = (score: number): string => {
  if (score >= 80) return "4";
  if (score >= 75) return "3.5";
  if (score >= 70) return "3";
  if (score >= 65) return "2.5";
  if (score >= 60) return "2";
  if (score >= 55) return "1.5";
  if (score >= 50) return "1";
  return "0";
};

// Helper to determine category
export const getCategory = (subject: string): SubjectScore['category'] => {
  if (subject.includes('คณิต')) return 'Math';
  if (subject.includes('วิทย์') || subject.includes('วิทยาศาสตร์')) return 'Science';
  if (subject.includes('ไทย') || subject.includes('อังกฤษ') || subject.includes('ต่างประเทศ') || subject.includes('Phonics') || subject.includes('Conversation')) return 'Language';
  if (subject.includes('สังคม') || subject.includes('ประวัติ') || subject.includes('ศาสนา')) return 'Social';
  if (subject.includes('ศิลปะ') || subject.includes('ดนตรี')) return 'Art';
  if (subject.includes('พลศึกษา') || subject.includes('การงาน')) return 'Activity';
  return 'Activity';
};

export const DIRECTOR = "นายอิสมาแอล มะลี";
export const CURRENT_YEAR = "2568";
export const YEAR_OPTIONS = ["2568", "2569", "2570", "2571"];

// Configuration for each grade level - EXPORTED NOW
export const GRADE_CONFIG: Record<string, { subjects: string[], teachers: string[] }> = {
  "ป.1": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สังคมศึกษา ศาสนาและวัฒนธรรม", "ประวัติศาสตร์", 
      "สุขศึกษาและพลศึกษา", "ศิลปะและดนตรี", "การงานอาชีพ", "ภาษาต่างประเทศ", 
      "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Phonics)"
    ],
    teachers: ["นางสาวแวรอฮายา สะแลแม", "นางสาวฟิรดาวส์ ตะโละมีแย"]
  },
  "ป.2": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สังคมศึกษา ศาสนาและวัฒนธรรม", "ประวัติศาสตร์", 
      "สุขศึกษาและพลศึกษา", "ศิลปะและดนตรี", "การงานอาชีพ", "ภาษาต่างประเทศ", 
      "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Phonics)"
    ],
    teachers: ["นางสูไรญา อาลีมามะ", "นางสาวซานีซะห์ เฮง"]
  },
  "ป.3": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สุขศึกษาและพลศึกษา", "ศิลปะและดนตรี", 
      "ภาษาต่างประเทศ", "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Phonics)"
    ],
    teachers: ["นางสาวซอฟียะฮ์ เจะสะอิ", "นางสาวนาดียะห์ ยะโกะ"]
  },
  "ป.4": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สังคมศึกษา ศาสนาและวัฒนธรรม", "ประวัติศาสตร์", 
      "สุขศึกษาและพลศึกษา", "ศิลปะและดนตรี", "การงานอาชีพ", "ภาษาต่างประเทศ", 
      "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Conversation)"
    ],
    teachers: ["นางนิภาภรณ์ ซีเดะ", "นางซีตีฮาวอ ดาโอะ"]
  },
  "ป.5": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สังคมศึกษา ศาสนาและวัฒนธรรม", "ประวัติศาสตร์", 
      "สุขศึกษาและพลศึกษา", "ศิลปะและดนตรี", "การงานอาชีพ", "ภาษาต่างประเทศ", 
      "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Conversation)"
    ],
    teachers: ["นายมูฮำมัด สะแต", "นายอาหามะ โต๊ะมิง"]
  },
  "ป.6": {
    subjects: [
      "ภาษาไทย", "คณิตศาสตร์", "วิทยาศาสตร์", "สุขศึกษาและพลศึกษา", 
      "ภาษาต่างประเทศ", "ศาสนาและอัลกุรอาน", "อังกฤษเพื่อการสื่อสาร (Conversation)"
    ],
    teachers: ["นางสาวฟิรดาว แลมีซอ", "นางสาวโซเฟีย เบ็ญฮาวัน"]
  }
};

// Raw Data Strings
const P1_DATA = `
เด็กชายซาฟี	มะมิง	68	78	81	74	75	78	83	80	77	94	75
เด็กชายดาเนียล	หะมะ	59	78	72	72	73	79	70	72	69	67	70
เด็กชายนิฮานาฟี	ดาโอะ	50	50	50	55	55	55	56	55	50	50	51
เด็กชายบุคอรี	ลาเตะ	58	82	67	75	79	81	77	74	66	66	65
เด็กชายบุนยานา	มะรอแม	57	87	80	78	80	85	82	80	80	83	81
เด็กชายฟัตฮี	แวกะจิ	55	91	70	75	72	83	82	80	70	71	69
เด็กชายฟารูก	นะแด	87	87	77	78	75	85	85	86	76	96	78
เด็กชายมูฮัมหมัดอัฎฮา	กาโฮง	95	90	94	80	79	84	90	93	81	96	80
เด็กชายมูฮำหมัดรอกิบ	เจะมิ	60	88	80	78	80	85	90	92	80	96	80
เด็กชายมูฮำหมัดอัฟนัน	สานิ	60	78	71	75	77	50	70	72	68	86	71
เด็กชายอับดุลคอลิบ	ตาแล	80	89	82	80	82	85	93	95	81	96	82
เด็กชายอัมมาร	มาโอะ	50	50	50	65	55	55	60	67	61	52	61
เด็กชายอัลดุลฮากีม	ยามู	60	74	72	78	79	84	75	72	70	94	71
เด็กชายอานาบาวี	ยูโซะ	50	50	50	55	55	74	65	68	53	51	51
เด็กชายอาฟันดี	มีเระ	50	50	52	50	55	55	55	52	52	51	52
เด็กชายอาลีฟ	ดือราแม	68	68	69	75	74	82	78	75	70	73	70
เด็กชายอิสมาแอ	ดูลี	55	56	63	72	70	81	79	70	62	52	62
เด็กชายมูฮัมหมัดซอลีฮีน	มะดีซู	0	0	0	0	0	0	0	0	0	0	0
เด็กชายอาบูคอรี	หวันโส๊ะ	0	0	0	0	0	0	0	0	0	0	0
เด็กหญิงซอบารียะห์	ดาราบากอ	62	95	80	81	84	84	85	84	78	96	80
เด็กหญิงซัยนับ	วาเลาะ	65	83	80	79	80	84	80	82	72	97	74
เด็กหญิงนัสริน	มามะ	65	78	68	78	80	82	80	82	68	55	71
เด็กหญิงนาซีม	ปะเปาะ	91	91	84	80	82	83	90	92	82	97	83
เด็กหญิงนูรอาวียา	กาซอ	60	80	73	79	81	82	78	75	72	94	76
เด็กหญิงอลินดา	นาแว	60	88	78	81	80	84	83	80	76	89	77
เด็กหญิงอัสมะอ์	มะแอ	57	61	55	71	74	78	65	66	60	82	60`;

const P2_DATA = `
เด็กชายซอลาฮุดดีน	อิสมิง	82	72	80	78	80	84	80	80	80	95	75
เด็กชายนิอาลีฟ	แวดือเระ	62	60	73	75	76	82	80	75	84	90	70
เด็กชายฟาเดล	ซีนา	72	58	65	78	75	85	80	74	73	90	71
เด็กชายฟาอีซ	มีเระ	55	53	65	70	65	78	70	71	73	71	68
เด็กชายมูฮัมหมัดซาฮรน	ปุเต๊ะ	60	47	70	73	75	82	75	72	70	66	72
เด็กชายมูฮามัดอาลีฟิล	บาสา	83	62	81	78	75	82	80	75	99	89	81
เด็กชายมูฮำหมัดอิลฮัม	สานิ	73	60	62	72	75	83	83	78	61	68	64
เด็กชายอามีน	สือแม	80	57	78	73	75	81	78	80	86	90	80
เด็กชายฮากีม	ปูเตะ	85	55	82	72	74	82	85	81	92	96	81
เด็กชายอิรฮัม	แวดือเระ	58	51	60	65	67	78	72	71	50	74	70
เด็กหญิงนุรฟาเดีย	เปาะสา	88	62	80	78	75	80	90	84	77	75	83
เด็กหญิงนุรฮาซีกิม	มานิ๊	60	60	67	70	65	80	72	76	65	71	74
เด็กหญิงนูรฟาตีฮะห์	ปูแทน	70	51	78	65	62	78	80	79	50	77	72
เด็กหญิงฟาดีหล๊ะ	ตาเห	80	61	80	72	70	75	83	80	86	79	75
เด็กหญิงฟิตรี	เจ๊ะมิง	58	54	75	65	60	75	75	72	67	77	68
เด็กหญิงอันนูร	สาและ	85	62	86	78	80	81	90	85	90	92	84
เด็กหญิงอาซียะห์	กาโฮง	92	77	87	79	81	80	92	86	98	78	85
เด็กหญิงอาอีเซาะห์	สะเตาะ	78	58	78	75	73	78	80	79	88	81	81
เด็กหญิงอาวินด้า	สาแลแม	90	62	84	75	78	82	93	85	81	69	83`;

const P3_DATA = `
เด็กชายฟาริส	สมาแอ	65	70	75	82	83	71	72	60
เด็กชายอารีฟีน	กาโฮง	85	88	83	82	86	78	88	82
เด็กชายอารีฟีน	ยูโซะ	51	61	58	81	70	63	79	55
เด็กชายมูฮำหมัดมุสลิม	กะปีเยาะ	51	72	59	82	77	73	55	78
เด็กชายอารีฟีน	สมาแอ	50	63	60	80	80	66	83	60
เด็กชายชามิล	สะแต	75	66	70	78	78	73	82	50
เด็กชายมูฮำหมัดชารีฟ	บาราเห็ง	80	75	80	80	90	72	73	85
เด็กชายมูฮำหมัดไฟซอล	มูนะ	60	67	78	79	67	74	58	55
เด็กชายฮัมดี	สาแย	57	70	67	81	80	70	83	58
เด็กชายมูฮัมหมัด	หะยีวามิส	59	70	60	82	81	72	69	65
มูฮัมหมัดอากีล์	เจ๊ะมะ	85	95	86	84	92	85	87	84
เด็กชายมูฮำหมัดอาลีฟ	เซ็ง	53	75	75	81	80	73	72	72
เด็กชายมูฮัมหมัด	ยือลาแป	53	84	58	78	79	80	63	81
เด็กชายมูฮัมหมัดไฟซอล	ปุเต๊ะ	82	84	80	82	84	75	66	72
เด็กชายมูฮัมหมัดลุฏฟี	กาหลง	85	97	82	84	83	89	92	87
เด็กชายฟุรกอน	ตาแล	64	89	78	81	80	77	92	85
เด็กชายอับดุลเลาะฮ์	เจะอาแซ	0	0	0	0	0	0	0	0
เด็กหญิงนิสรีน	ประดู่	85	85	81	80	91	73	96	89
เด็กหญิงนูรฮานีซา	กาซอ	80	87	81	81	88	78	87	82
เด็กหญิงนูรุลอีมาน	บาสา	83	85	84	80	82	80	92	88
เด็กหญิงซูไวรียะห์	ยือลาแป	88	91	88	81	93	84	87	98
เด็กหญิงอาซียะห์	ตานิง	85	84	87	83	84	82	96	80
เด็กหญิงมูรณีย์	อูมา	82	83	82	84	89	75	84	99
เด็กหญิงอัยด้า	มะรอแม	81	85	85	82	92	80	87	94
เด็กหญิงตัสนีม	มามะ	60	71	73	82	85	75	82	53
เด็กหญิงนูรอาฆีฟานัยลา	บือราเฮง	87	79	84	84	89	83	95	97
เด็กชายมูชัรรีฟ	อาแว	88	91	89	84	87	85	98	95
เด็กหญิงนิดานีน	สาแม	87	88	83	82	91	82	85	80`;

const P4_DATA = `
เด็กชายมูฮัมหมัดอัดฟาน	สะอิ	60	75	55.3	75	80	82	82	85	89	91	73
เด็กชายมุสตากีม	ดูลี	66	72	57.8	72	79	80	70	85	84	69	74
เด็กชายยุฟรี	อูมา	70	64	55	78	80	85	85	87	91	72	76
เด็กชายอิรฟาร	เจะกา	62	73	60.5	75	77	81	85	85	80	92	73
เด็กชายอารีฟ	หะยีเจ๊ะมะ	62	51	50	70	75	79	70	70	78	61	70
เด็กชายสุลาวัน	สาแม็ง	60	52	52.5	71	74	81	70	78	80	89	71
เด็กชายอิบรอฮีม	หวันโส๊ะ	0	0	0	0	0	0	0	0	0	0	0
เด็กหญิงฟิรเดาว์	บาราเห็ง	81	90	81.8	83	81	82	89	97	94	98	91
เด็กหญิงนูรรอยญาน	สะมาแอ	81	98	85.3	85	84	84	95	96	98	89	90
เด็กหญิงซอฟียะห์	ดอเลาะ	70	62	65.8	78	79	79	92	85	90	70	75
เด็กหญิงมูรนี	เจะโด	65	44	51	65	70	78	68	70	70	50	69
เด็กหญิงอาชิชา	สาแลแม	79	83	70.3	82	81	82	95	90	97	72	83
เด็กหญิงฟาเดีย	กีโต๊ะ	71	49	50.5	70	74	78	55	78	83	63	68
เด็กหญิงสุไวบะห์	ตานิง	82	97	82.5	83	82	82	92	96	96	95	84
เด็กหญิงนูรตัสนิม	เดนดายัด	80	74	70.3	82	83	83	92	95	85	73	78
เด็กหญิงนูรเอมีเลีย	เปาะลี	65	56	50.8	75	74	79	67	75	88	61	67`;

const P5_DATA = `
เด็กชายมูฮัมมัดฟิตรี	ประดู่	60	66	65	78	79	80	84	82	74	66	60
เด็กชายซัยฟูรุตดิง	มะรอแม	85	79	85	81	82	84	87	84	80	84	95
เด็กชายฮานาฟี	แวกะจิ	55	50	57	70	75	79	75	73	62	50	68
เด็กชายค็อยรุล	สือแม	75	61	82	78	80	82	87	84	80	71	94
เด็กชายอิลฮาม	ตาเห	50	50	50	55	50	75	66	70	52	50	70
เด็กชายมูฮัมหมัดฮาฟิส	สาแม็ง	50	58	70	77	79	81	78	75	63	50	77
เด็กชายอิสมาแอล	สะเตาะ	60	65	70	78	80	81	81	82	74	50	86
เด็กชายอาดัม	บากา	80	80	83	82	81	82	86	84	81	96	95
เด็กชายซุบฮี	โต๊ะลี	57	50	68	75	77	80	77	78	62	50	77
เด็กชายมูฮัมหมัดฟักรูลเลาะฮ์	เจ๊ะหลง	65	51	62	77	75	82	75	78	65	52	58
เด็กชายอาฮัมมัด	เจ๊ะแล	90	83	84	82	80	83	94	90	83	74	95
เด็กชายซราวุธ	สะแต	60	55	70	75	74	81	83	82	62	50	78
เด็กหญิงซัมมูนา	กาโฮง	75	56	68	72	77	80	72	78	68	57	77
เด็กหญิงบนาน	ดอเล๊าะ	90	91	88	83	80	84	93	90	86	100	98
เด็กหญิงอะดีบะฮ์	เจ๊ะหลง	89	71	81	80	81	82	88	85	78	60	86
เด็กหญิงนาริศสา	ดามะ	95	92	90	84	82	85	95	92	87	100	98
เด็กหญิงนุรชีลา	ยือลาแป	89	76	83	80	82	82	95	91	81	71	95
เด็กหญิงนูรฮาวาตี	กีละ	80	76	80	81	80	83	95	90	80	77	92
เด็กหญิงซีตีนูรฉะซ์	บือราเฮง	80	68	80	80	79	82	83	81	77	74	82`;

const P6_DATA = `
เด็กชายมูฮำหมัด	สะตาเร็ง	55	55	58	80	46	66	68
เด็กชายฮาซัน	ปูเตะ	51	69	75	83	75	70	72
เด็กชายอัชอารี	เจ๊ะแล	57	48	75	84	53	70	74
เด็กชายอับดุลปาตะห์	ยือลาแป	87	87	88	85	80	70	84
เด็กชายมูฮัมหมัดฟุรกอน	สานิ	50	27	57	78	32	50	53
เด็กชายคูสรี	เจะบือเฮง	51	29	57	81	30	50	54
เด็กชายอาบีดิง	บาสา	55	46	68	81	27	50	53
เด็กชายฟุรกอน	นะแด	70	63	76	79	80	57	69
เด็กชายอาลีฟีล	หมัดบก	60	45	75	84	61	52	63
เด็กหญิงนัสริน	มานิ๊	60	75	63	81	63	81	74
เด็กหญิงตัสนีม	วาจิ	70	86	84	82	88	77	82
เด็กหญิงสุวัยการ	ดาโอะ	74	68	80	83	60	64	74
เด็กหญิงนุรซูวาณีย์	ซีนา	75	54	78	82	60	80	79
เด็กหญิงนูรูซัมฟาราย์	กาโฮง	65	48	73	80	28	74	74
เด็กหญิงนูรมา	ตาเห	65	62	62	80	62	71	67
เด็กหญิงนูรอัศวาณีย์	เจ๊ะมะ	85	79	78	81	86	71	76
เด็กหญิงบิสมี	มะมิง	93	93	88	85	83	93	84
เด็กหญิงอาบีร	มาโอะ	75	63	73	82	52	67	73
เด็กหญิงนูรฮาซีกีน	ปุเต๊ะ	67	69	67	82	60	70	74
เด็กหญิงนูรฮาซีกีน	สาแม็ง	70	71	67	81	68	66	73
เด็กหญิงนูรฮากีมะห์	ยามู	89	90	87	87	85	93	84
เด็กหญิงนูรอิลฮาม	สาและ	74	53	68	81	73	88	68
เด็กชายอาลีฟ	กะปีเยาะ	78	78	65	80	45	50	52`;

// Parsing Function
const parseData = (gradeStr: string, rawData: string): Student[] => {
  const lines = rawData.trim().split('\n');
  const config = GRADE_CONFIG[gradeStr];
  
  if (!config) return [];

  return lines.map((line, index) => {
    // Split by tabs or multiple spaces
    const parts = line.trim().split(/\s+/);
    
    // Name is usually parts[0] + parts[1] (First Last)
    // But sometimes parts[0] includes title like เด็กชาย...
    // Let's assume standard format: First Last Score1 Score2 ...
    // Note: The data sometimes has spaces within names? No, usually First Last Score...
    
    const firstName = parts[0];
    const lastName = parts[1];
    const scoresRaw = parts.slice(2);
    
    // Safety check
    if (scoresRaw.length < config.subjects.length) {
      console.warn(`Data mismatch for ${firstName} ${lastName} in ${gradeStr}`);
    }

    const scores: SubjectScore[] = config.subjects.map((sub, idx) => {
      const scoreVal = parseFloat(scoresRaw[idx] || "0");
      return {
        subjectName: sub,
        score: scoreVal,
        fullScore: 100,
        grade: calculateGrade(scoreVal),
        category: getCategory(sub)
      };
    });

    // Calculate GPA
    const totalGrade = scores.reduce((sum, s) => sum + parseFloat(s.grade), 0);
    const gpa = scores.length > 0 ? totalGrade / scores.length : 0;

    // Generate pseudo ID like P101, P102
    const gradeNum = gradeStr.replace('ป.', '');
    const id = `${gradeNum}${String(index + 1).padStart(2, '0')}`; // e.g., 101, 102

    return {
      id: id,
      firstName: firstName,
      lastName: lastName,
      class: gradeStr,
      semester: `1/${CURRENT_YEAR}`,
      academicYear: CURRENT_YEAR,
      image: `https://picsum.photos/seed/${id}${gradeStr}/200/200`, // Consistent random image
      gpa: parseFloat(gpa.toFixed(2)),
      scores: scores,
      teachers: config.teachers,
      director: DIRECTOR
    };
  });
};

export const MOCK_STUDENTS: Student[] = [
  ...parseData("ป.1", P1_DATA),
  ...parseData("ป.2", P2_DATA),
  ...parseData("ป.3", P3_DATA),
  ...parseData("ป.4", P4_DATA),
  ...parseData("ป.5", P5_DATA),
  ...parseData("ป.6", P6_DATA),
];
